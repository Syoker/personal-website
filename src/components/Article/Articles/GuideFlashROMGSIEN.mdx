import { Head } from 'src/components/shared';
import { Video } from 'src/components/Article';

<Head
	title="[Guide] Flash ROM GSI"
	description="Guide to flash a GSI ROM on the Motorola One Fusion | Astro"
	ogUrl="https://syoker.vercel.app/blog/motorolaonefusion/guide-flash-rom-gsi"
	ogTitle="[Guide] Flash ROM GSI"
	ogDescription="Guide to flash a GSI ROM on the Motorola One Fusion | Astro"
	ogImage="https://raw.githubusercontent.com/Syoker/personal-website/main/public/img/banner-flashromgsi.png"
/>

In this guide, I will show you how to flash a GSI ROM on your device. This process will format your device, so I recommend you to make a backup before.

All this is at your own risk, I'm not responsible for any damage caused to your device.

## **¿What I need?**

- ### **SDK Platform Tools**
    
    The _Android SDK Platform tools_ are a component of the Android SDK. They include tools that interact with the Android platform, such as <code><a href="https://developer.android.com/studio/command-line/adb">adb</a></code>, <code><a href="https://android.googlesource.com/platform/system/core/+/master/fastboot/#fastboot">fastboot</a></code> y <code><a href="https://developer.android.com/topic/performance/tracing/command-line">systrace</a></code>. These tools are required for Android app development, or if you want to unlock the bootloader of your device and update it with a new system image.

  	Download link - [SDK Platform Tools](https://developer.android.com/studio/releases/platform-tools)
    
- ### **Motorola Drivers**
    
    This contains the USB drivers so that the PC can recognize your device and work with it when it is in Bootloader or Fastbootd.
    
    Download link - [Motorola](https://motorola-global-es-latam.custhelp.com/app/answers/detail/a_id/89882)
    
- ### **Official firmware**
    
    You will need to download official firmware corresponding to your software channel for your device, **NEVER DOWNLOAD A FIRMWARE FROM ANOTHER CHANNEL.** To find out which firmware corresponds to your device, you need to look at the channel it belongs to in the settings app, under "About phone" in "Software Channel".
    
    Download link - [Mirrors Lolinet](https://mirrors.lolinet.com/firmware/moto/astro/official/)
    
- ### **Windows Terminal (optional)**
    
    If you have windows 8, 8.1 or 10, download this terminal from the Windows Store, as you will get a feature that you will need in this guide. Once you have obtained the terminal, configure it so that the default profile is the command prompt (CMD).
    
    Download link - [Microsoft Store](https://www.microsoft.com/store/productId/9N0DX20HK701)
    
- ### **USB debugging (optional)**
    
    In this guide we will use USB debugging to access the bootloader mode, it is not necessary if you are already in bootloader mode or if you are going to access it in another way (with a buttons combination), but I recommend the way it is going to be shown in this guide.
    
    To enable USB debugging, you have to go to the settings app, in the "About phone" section under "Build number" and tap 7 times. Then, you have to access the "Developer options" in the settings app under "System" and enable "USB debugging".
    
- ### **Bootloader unlocked**
    
    You need to have unlocked the bootloader to be able to install a Custom Recovery on your device. If you haven't unlocked it yet, I'll leave you the link to the guide I made explaining step by step what you have to do.
    
    Link of the guide - [[Guide] Unlock bootloader](https://syoker.vercel.app/blog/motorolaonefusion/guide-unlock-bootloader/)
    
- ### **Custom Recovery and ROOT (optional)**
    
    I recommend having a Custom Recovery and having ROOT on the device before installing a GSI, since GSI's have several visual problems on our device, which are fixed with Magisk modules. So, if you haven't installed a Custom Recovery yet, I'll leave you a link to a guide I made to install a Custom Recovery and also a .zip of a Magisk flashable by a Custom Recovery.
    
    Link of the guide - [[Guide] Flash Custom Recovery](https://syoker.vercel.app/blog/motorolaonefusion/guide-flash-custom-recovery/)
    
    Link of Magisk - [Magisk v25.2](/files/Magisk-v25.2.zip)
    
- ### **Generic System Image (GSI)**
    
    GSIs have different variants for each type of architecture, partition system, whether they have gapps or are vanilla, and so on. Below I will show you how to distinguish each type of version.

	```
	Architectures:
	- arm: 32-bit ARM architecture.
	- a64: 32-bit ARM architecture with 64-bit binder.
	- arm64: 64-bit ARM architecture.
	Partition system:
	- A: Devices with one partition (a-only).
	- B: Devices with two partitions (A/B).
	System version:
	- g: Contains gapps (gapps).
	- o: Contains GO version of gapps (go-gapps).
	- v: Doesn't contain gapps (vanilla).
	- f: Contains an open-source gapps system (floss).
	Superuser:
	- N: No superuser.
	- S: Has PHH superuser (conflicts with Magisk).
	- Z: Has Dynamic Superuser by Eremitein (conflicts with Magisk).
	Build type:
	- vndklite or lite: For devices with vendor vndklite or for a read-write system on normal devices.
	- personal: Contains developer's personal mods.
	- secure: With superuser removed.
	Size of gapps (if there is):
	- Normal: Normal amount of gapps.
	- Slim: With a reduced amount of gapps.
	```

    To note, our device has an ARM64 architecture and an A/B partitioning system. Also note that it supports a maximum image size of 3.66GB.
    
    The version I personally recommend would be `arm64_BgN Normal`.
    
    Anyway, I'll leave you a link to a channel where we pass GSI ROMs that work on our device perfectly, the above is in case you want to try on your own GSI ROMs that are not in the channel.
    
    Link of channel - [Motorola One Fusion | Updates](https://t.me/OneFusionUpdates/3)
    

## **Procedure for flashing the GSI ROM**

1. Unzip the platform-tools folder obtained from **Android Developers**page, then unzip the official firmware file obtained from **Mirrors Lolinet** and also unzip the GSI file and move all the files from this folder to the platform-tools folder.
    

![Folder example](/img/guide-examplefolder.png)

2. If you have the **Windows Terminal** obtained from the **Microsoft Store**, simply open the CMD inside the folder by right-clicking on an empty part of the folder and selecting the "Open in Terminal" option.

<Video src="/video/opencommandprompt.mp4" />    

If you don't have the **Windows Terminal**, inside the folder in an empty space, shift+right-click and select the option "Open PowerShell window here", type `cmd` inside the window and press enter.

<Video src="/video/openwindowspowershell.mp4" />

3. Connect the device to the PC, type in the CMD `adb devices` (the phone has to be on for this command to work, in case it is already in bootloader, type `fastboot devices`) and press enter. If the console doesn't return
    
    ```bash
    List of devices   attached
    ZE222BZWFF        device
    ```
    
    then make sure you have your device properly connected, or have enabled USB debugging.
    
4. Now reboot to the bootloader (if you aren't in it) with `adb reboot bootloader` or with the key combination "volume - and power" (you have to hold down these buttons until the bootloader screen appears).
    
    Either way, this will access the bootloader, which has a screen with text and the Android robot lying down with an open lid.
    
5. Once in fastbootd, we will set the active partition of the device in the A with:
    
	```bash
	fastboot --set-active=a
	```
    
6. We will then proceed to disable the [AVB](https://source.android.com/security/verifiedboot/avb) with the command:
    
	```bash
	fastboot --disable-verification flash vbmeta vbmeta.img
	```
    
7. Once verified boot is disabled, we will delete the current system and then install the one we want with the following command:
    
	```bash
	fastboot erase system
	```
    
8. Now we will flash a [special product](/files/product_gsi.img) (paste the downloaded file inside the platform-tools folder and don't change the name) that will give us more space for the GSI with the following command:
    
	```bash
	fastboot flash product product_gsi.img
	```
    
9. Now it's time to flash the GSI ROM, we will use the following command:
    
	```bash
	fastboot flash system "system.img"
	```
    
    Where "system.img" is the name of the GSI ROM, without the quotes and with the ".img".
    
10. After installing the GSI ROM, we will expand the partition size to have more space for the modules we will install, this step is optional, but recommended (keep in mind that this command will cause bootloop if you have not previously rooted the phone). We will use the following command:
    
	```bash
	fastboot resize-logical-partition system_a 3800000000
	```
    
11. Now let's reboot to bootloader with `fastboot reboot bootloader` to format the device (if you skip this step, you may get a bootloop) with the following command:
    
	```bash
	fastboot -w
	```
    
  	If this command doesn't work, you can use this one:
    
		```bash
  	fastboot erase userdata
		```
    
12. Once the system is formatted, boot into it with `fastboot reboot` and you're done.
    

## **Solutions and tips**

- ### **IMEI backup**
    
    Always make a backup of your IMEI in case of a possible case of IMEI loss. All you have to do is, from OrangeFox or TWRP go to the backup section, select an external storage (SD card) and add a new backup, selecting the folders EFS, Modem and Persist.
    

![guide_imei-backup](/img/guide-imeibackup.png)
- ### **eMMC life**
    
    To see the life of your eMMC (the internal storage) just run the command I'm going to leave you from [Termux](https://f-droid.org/repo/com.termux_118.apk). You need to root your device.
    
		```bash
		su -c cat /sys/class/mmc_host/mmc0/mmc0:0001/life_time
		```
    
    Your eMMC is in danger if the answer to this command is 0x08 0x03 or more, the closer its number is to the above mentioned, the more worn out your eMMC is. The number of a new eMMC is 0x01 0x01.
    

![guide_emmc-life](/img/guide-emmclife.png)

- ### **Solution to the SMS problem**
    
    To solve the problem of SMS not arriving, simply go to "Settings/Phh Treble Settings/IMS features" and select the option "Install IMS APK for Qualcomm vendor", then wait for the apk to install (a warning banner will pop up) and reboot the device.
    

![guide_solution-to-sms-problem](/img/guide-solutionsmsproblem.png)

- ### **Device certification**
    
    If you have the Play Store certification issue (you will notice when you get a notification saying "This device is not certified") what you need to do is install the [Device ID](https://play.google.com/store/apps/details?id=com.evozi.deviceid) app, inside the app copy the GSF ID (Google Service Framework ID), with that ID, register it on Google [here](https://www.google.com/android/uncertified) (paste your ID in the only text entry place on the page and tap the "Register" button), then restart the phone and clear the Google Play Store data under "App Info/Storage and Cache/Free up storage space" and you're done (it takes a while to apply).
    

![guide_device-certification](/img/guide-devicecertification.png)

If you have any questions, please visit the Telegram group in Spanish (currently doesn't exist in English) of our device [Motorola One Fusion | Español™](https://t.me/MotorolaOneFusionES) (If you find any translation errors, let me know via this group or by md on [telegram](https://t.me/Syoker)).
